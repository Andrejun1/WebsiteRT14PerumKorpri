<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Posyandu Perum Korpri Sambiroto</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.13.3/cdn.min.js"
      defer
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="home.css" />
  </head>
  <body x-data="posyanduApp()">
    <header>
      <nav class="container">
        <div class="logo">
          <i class="fa-solid fa-house-flag"></i>
          RT 14 Perum Korpri Sambiroto
        </div>
        <button class="hamburger" @click="menuOpen = !menuOpen">
          <i class="fas fa-bars"></i>
        </button>
        <ul class="nav-links" x-show="menuOpen" x-transition>
          <li><a href="#home">Beranda</a></li>
          <li><a href="gallery.html">Galeri</a></li>
          <li><a href="#jadwal">Pengumuman</a></li>
          <li><a href="#tentang">Tentang</a></li>
          <li><a href="#kontak">kontak</a></li>
        </ul>
        <button class="admin-btn" @click="showAdminLogin = true">
          <i class="fas fa-user-shield"></i> Admin
        </button>
      </nav>
    </header>

    <main>
      <section class="hero" id="home">
        <div class="container">
          <h1>
            <i class="fa-solid fa-tents"></i> RT 14 RW 08 Perum Korpri Sambiroto
          </h1>
          <p>
            kita terus jaga kekompakan dan semangat gotong royong yang sudah
            terjalin indah di antara kita. Dengan kebersamaan, lingkungan kita
            akan semakin nyaman, aman, dan penuh kehangatan. Tetap semangat,
            salam guyub rukun!
          </p>

          <!-- Image Carousel -->
          <div class="carousel-container" x-data="carousel()">
            <div class="carousel">
              <div
                class="carousel-slide"
                :class="{ active: currentSlide === 0 }"
                style="background-image: url('src/foto1.jpeg')"
              >
                <div class="slide-content">
                  <h3>Bank Sampah</h3>
                  <p>Pemilahan Sampah yang di lakukan ibu ibu warga RT 14</p>
                </div>
              </div>
              <div
                class="carousel-slide"
                :class="{ active: currentSlide === 1 }"
                style="background-image: url('src/foto2.jpeg')"
              >
                <div class="slide-content">
                  <h3>Menjenguk Warga</h3>
                  <p>Menjenguk salah satu warga RT 14 yang terkena musibah</p>
                </div>
              </div>
              <div
                class="carousel-slide"
                :class="{ active: currentSlide === 2 }"
                style="background-image: url('src/foto3.jpeg')"
              >
                <div class="slide-content">
                  <h3>Kebersihan Lingkungan</h3>
                  <p>Kerja Bakti Warga RT 14</p>
                </div>
              </div>
              <div
                class="carousel-slide"
                :class="{ active: currentSlide === 3 }"
                style="background-image: url('src/foto4.jpeg')"
              >
                <div class="slide-content">
                  <h3>Penyaluran Bantuan</h3>
                  <p>Pendistribusikan Bantuan Korban Banjir</p>
                </div>
              </div>
            </div>

            <button class="carousel-nav prev" @click="prevSlide()">
              <i class="fas fa-chevron-left"></i>
            </button>
            <button class="carousel-nav next" @click="nextSlide()">
              <i class="fas fa-chevron-right"></i>
            </button>

            <div class="carousel-indicators">
              <template x-for="(slide, index) in 4" :key="index">
                <div
                  class="indicator"
                  :class="{ active: currentSlide === index }"
                  @click="currentSlide = index"
                ></div>
              </template>
            </div>
          </div>
        </div>
      </section>

      <div class="container">
        <!-- Alert Messages -->
        <div
          x-show="alert.show"
          x-transition
          class="alert"
          :class="alert.type === 'success' ? 'alert-success' : 'alert-error'"
        >
          <span x-text="alert.message"></span>
        </div>

        <!-- Statistics Section -->
        <section class="stats-section">
          <div class="stat-card">
            <div class="stat-number">100+</div>
            <div class="stat-label">Warga Aktif</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">40+</div>
            <div class="stat-label">Kartu Keluarga</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">20+</div>
            <div class="stat-label">Lansia</div>
          </div>
          <div class="stat-card">
            <div class="stat-number">4+</div>
            <div class="stat-label">Bayi</div>
          </div>
        </section>

        <!-- Schedule Section -->
        <section class="content-section" id="jadwal">
          <h2 class="section-title">
            <i class="fas fa-calendar-alt"></i> Pengumuman
          </h2>

          <div x-show="loading" class="text-center">
            <div class="loading"></div>
            <p>Memuat jadwal...</p>
          </div>

          <div x-show="!loading && schedules.length === 0" class="text-center">
            <p>Belum ada Pengumuman.</p>
          </div>

          <div x-show="!loading && schedules.length > 0" class="schedule-grid">
            <template x-for="schedule in schedules" :key="schedule.id">
              <div class="schedule-card">
                <div class="schedule-date">
                  <i class="fas fa-calendar"></i>
                  <span x-text="formatDate(schedule.date)"></span>
                </div>
                <div class="schedule-time">
                  <i class="fas fa-clock"></i>
                  <span
                    x-text="schedule.time_start + ' - ' + schedule.time_end"
                  ></span>
                </div>
                <div class="schedule-activity" x-text="schedule.activity"></div>
                <div class="schedule-location">
                  <i class="fas fa-map-marker-alt"></i>
                  <span x-text="schedule.location"></span>
                </div>
                <div
                  x-show="schedule.description"
                  style="margin-top: 1rem; opacity: 0.9"
                  x-text="schedule.description"
                ></div>
              </div>
            </template>
          </div>
        </section>

        <!-- Admin Panel -->
        <section
          x-show="isAdmin"
          class="content-section admin-panel"
          :class="{ active: isAdmin }"
        >
          <h2 class="section-title"><i class="fas fa-cogs"></i> Panel Admin</h2>
          <div class="admin-actions">
            <button class="btn" @click="showAddSchedule = true">
              <i class="fas fa-plus"></i> Tambah Jadwal
            </button>
            <button class="btn btn-secondary" @click="logout">
              <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            </a>
          </div>

          <div x-show="schedules.length > 0">
            <h3>Kelola Jadwal</h3>
            <template x-for="schedule in schedules" :key="schedule.id">
              <div class="schedule-item">
                <div>
                  <strong x-text="schedule.activity"></strong><br />
                  <small
                    x-text="formatDate(schedule.date) + ' - ' + schedule.time_start + ' s/d ' + schedule.time_end"
                  ></small>
                </div>
                <div class="schedule-item-actions">
                  <button class="btn btn-small" @click="editSchedule(schedule)">
                    <i class="fas fa-edit"></i> Edit
                  </button>
                  <button
                    class="btn btn-danger btn-small"
                    @click="deleteSchedule(schedule.id)"
                  >
                    <i class="fas fa-trash"></i> Hapus
                  </button>
                </div>
              </div>
            </template>
          </div>
        </section>

        <!-- About Section -->
        <section class="content-section" id="tentang">
          <h2 class="section-title">
            <i class="fas fa-info-circle"></i> Tentang RT 14
          </h2>
          <p style="text-align: center; font-size: 1.1rem; line-height: 1.8">
            Warga RT 14, sebuah komunitas yang bukan hanya sekadar tetangga,
            melainkan keluarga besar yang selalu ada untuk satu sama lain. Mari
            terus rawat ikatan silaturahmi ini, jadikan setiap sudut RT 14
            sebagai cerminan kebersamaan, kepedulian, dan kehangatan hati.
            Dengan semangat kekeluargaan, kita wujudkan RT 14 yang nyaman, aman,
            dan penuh senyum.
          </p>
        </section>
      </div>
    </main>

    <!-- Kontak Section -->
   <section id="kontak" class="box-section">
      <h2 class="section-title">Kontak Kami</h2>
      <div class="contact-grid">
        <div class="contact-card">
          <h3>Pak Cahyo</h3>
          <p>085290109069</p>
          <a href="https://wa.me/6285290109069" class="whatsapp-button" target="_blank">
            <i class="fab fa-whatsapp"></i> Chat Sekarang
          </a>
        </div>
        <div class="contact-card">
          <h3>Bu Dewi</h3>
          <p>089676321245</p>
          <a href="https://wa.me/6289676321245" class="whatsapp-button" target="_blank">
            <i class="fab fa-whatsapp"></i> Chat Sekarang
          </a>
        </div>
      </div>
    </section>

    <!-- Floating Action Button -->
    <button
      class="fab"
      @click="window.scrollTo({ top: 0, behavior: 'smooth' })"
      title="Kembali ke atas"
    >
      <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Admin Login Modal -->
    <div class="modal" :class="{ active: showAdminLogin }">
      <div class="modal-content">
        <h3 style="margin-bottom: 1.5rem; text-align: center">Login Admin</h3>
        <form @submit.prevent="adminLogin">
          <div class="form-group">
            <label for="adminPassword">Password Admin:</label>
            <input
              type="password"
              id="adminPassword"
              x-model="adminPassword"
              required
            />
          </div>
          <div style="text-align: center">
            <button type="submit" class="btn" :disabled="loggingIn">
              <span x-show="loggingIn" class="loading"></span>
              <span x-show="!loggingIn">Login</span>
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              @click="showAdminLogin = false"
            >
              Batal
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Add/Edit Schedule Modal -->
    <div class="modal" :class="{ active: showAddSchedule }">
      <div class="modal-content">
        <h3
          style="margin-bottom: 1.5rem; text-align: center"
          x-text="editingSchedule ? 'Edit Jadwal' : 'Tambah Jadwal Baru'"
        ></h3>
        <form @submit.prevent="saveSchedule">
          <div class="form-group">
            <label for="scheduleDate">Tanggal:</label>
            <input
              type="date"
              id="scheduleDate"
              x-model="scheduleForm.date"
              required
            />
          </div>
          <div class="form-group">
            <label for="scheduleTimeStart">Waktu Mulai:</label>
            <input
              type="time"
              id="scheduleTimeStart"
              x-model="scheduleForm.time_start"
              required
            />
          </div>
          <div class="form-group">
            <label for="scheduleTimeEnd">Waktu Selesai:</label>
            <input
              type="time"
              id="scheduleTimeEnd"
              x-model="scheduleForm.time_end"
              required
            />
          </div>
          <div class="form-group">
            <label for="scheduleActivity">Kegiatan:</label>
            <input
              type="text"
              id="scheduleActivity"
              x-model="scheduleForm.activity"
              required
              placeholder="Contoh: Arisan RT"
            />
          </div>
          <div class="form-group">
            <label for="scheduleLocation">Lokasi:</label>
            <input
              type="text"
              id="scheduleLocation"
              x-model="scheduleForm.location"
              required
              placeholder="Contoh: Balai Desa"
            />
          </div>
          <div class="form-group">
            <label for="scheduleDescription">Deskripsi (Opsional):</label>
            <textarea
              id="scheduleDescription"
              x-model="scheduleForm.description"
              rows="3"
              placeholder="Deskripsi tambahan tentang kegiatan"
            ></textarea>
          </div>
          <div style="text-align: center">
            <button type="submit" class="btn" :disabled="saving">
              <span x-show="saving" class="loading"></span>
              <span
                x-show="!saving"
                x-text="editingSchedule ? 'Update' : 'Simpan'"
              ></span>
            </button>
            <button
              type="button"
              class="btn btn-secondary"
              @click="closeScheduleModal"
            >
              Batal
            </button>
          </div>
        </form>
      </div>
    </div>

    <script src="home.js"></script>
  </body>
</html>
